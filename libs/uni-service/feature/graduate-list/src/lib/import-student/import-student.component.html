<ksp-top-nav>
  <span header>{{ headers[pageType][0] }}</span>
  <span subHeader>{{ headers[pageType][1] }}</span>
  <span detail> > {{ headers[pageType][2] }}</span>
</ksp-top-nav>

<div class="container">
  <div class="title__label">รายละเอียดใบคำขอ</div>
  <div class="content__container">
    <ksp-request-header-info
      [requestDate]="'10 ตุลาคม 2565'"
      [requestNumber]="'112234467876543'"
    ></ksp-request-header-info>
    <hr />

    <div class="detail__container">
      <div class="header__detail">
        <div class="detail__header">{{ headers[pageType][2] }}</div>
        <div *ngIf="pageType === importType.studentList">
          <button type="button" class="btn btn-upload-secondary btn-dowload">
            <img src="/assets/images/img-uni/microsoft excel.png" />
            ดาวน์โหลดแบบฟอร์ม
          </button>

          <ksp-file-upload id="upload__button"></ksp-file-upload>
        </div>
      </div>

      <div class="table">
        <p-table
          [value]="users"
          responsiveLayout="scroll"
          dataKey="id"
          editMode="row"
        >
          <ng-template pTemplate="header">
            <tr>
              <th
                class="table__order"
                *ngIf="pageType === importType.studentList"
              >
                ลำดับ
              </th>
              <th
                class="table__header"
                *ngIf="pageType === importType.graduateList"
              >
                ครั้งที่สภาอนุมัติ
              </th>
              <th
                class="table__header"
                *ngIf="pageType === importType.graduateList"
              >
                วันที่สภาอนุมัติ
              </th>
              <th
                class="table__header"
                *ngIf="pageType === importType.graduateList"
              >
                วันที่จบการศึกษา
              </th>
              <th
                class="table__header"
                *ngIf="pageType === importType.graduateList"
              >
                สถานที่ปฏิบัติการสอน
              </th>
              <th
                class="table__header"
                *ngIf="pageType === importType.studentList"
              >
                วันที่รับเข้า
              </th>
              <th
                class="table__header"
                *ngIf="pageType === importType.graduateList"
              >
                วันที่เข้ารับการศึกษา
              </th>
              <th class="table__header">
                เลขบัตรประจำตัวประชาชน/<br />
                เลขประจำตัวคุรุสภา
              </th>
              <th class="table__header">หมายเลขหนังสือเดินทาง</th>
              <th class="table__header">คำนำหน้าชื่อ</th>
              <th class="table__header">ชื่อ</th>
              <th class="table__header">นามสกุล</th>
              <th class="table__header">คำนำหน้าชื่อ</th>
              <th class="table__header">ชื่อ</th>
              <th class="table__header">นามสกุล</th>
              <th class="table__header">เบอร์โทรศัพท์มือถือ</th>
              <th class="table__header">วัน/เดือน/ปีเกิด(พ.ศ.)</th>
              <th class="table__header">ที่อยู่</th>
              <th class="table__header"></th>
            </tr>
          </ng-template>
          <ng-template
            pTemplate="body"
            let-product
            let-editing="editing"
            let-ri="rowIndex"
          >
            <tr [pEditableRow]="product">
              <td
                class="table__detail"
                *ngIf="pageType === importType.studentList"
              >
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    {{ product.id }}
                  </ng-template>

                  <ng-template pTemplate="output">
                    {{ product.id }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td
                class="table__detail"
                *ngIf="pageType === importType.graduateList"
              >
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input
                      class="approvetime__input"
                      pInputText
                      type="number"
                      min="0"
                      [(ngModel)]="product.approveTime"
                      required
                    />
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.approveTime }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td
                class="table__detail"
                *ngIf="pageType === importType.graduateList"
              >
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input
                      class="date__input"
                      pInputText
                      type="date"
                      [(ngModel)]="product.graduateDate"
                      required
                    />
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.graduateDate }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td
                class="table__detail"
                *ngIf="pageType === importType.graduateList"
              >
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input
                      class="date__input"
                      pInputText
                      type="date"
                      [(ngModel)]="product.approveDate"
                      required
                    />
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.approveDate }}
                  </ng-template>
                </p-cellEditor>
              </td>

              <td
                class="table__detail"
                *ngIf="pageType === importType.graduateList"
              >
                <div (click)="searchAddress()" class="table__expand">
                  สถานที่ปฏิบัติการสอน
                </div>
              </td>

              <td class="table__detail">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input
                      class="date__input"
                      pInputText
                      type="date"
                      [(ngModel)]="product.startDate"
                      required
                      [disabled]="pageType === importType.graduateList"
                    />
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.startDate }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td class="table__detail">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input
                      pInputText
                      type="text"
                      [(ngModel)]="product.personId"
                      required
                      [disabled]="pageType === importType.graduateList"
                    />
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.personId }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td class="table__detail">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input
                      pInputText
                      type="text"
                      [(ngModel)]="product.passportId"
                      required
                      [disabled]="pageType === importType.graduateList"
                    />
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.passportId }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td class="table__detail">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <mat-select
                      [disabled]="pageType === importType.graduateList"
                      [ngClass]="
                        pageType === importType.graduateList
                          ? 'disable__prefix'
                          : ''
                      "
                    >
                      <mat-option
                        *ngFor="let ThPrefix of ThPrefixes"
                        [value]="ThPrefix.value"
                      >
                        {{ ThPrefix.label }}
                      </mat-option>
                    </mat-select>
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.titleTh }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td class="table__detail">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input
                      pInputText
                      type="text"
                      [(ngModel)]="product.firstNameTh"
                      required
                      [disabled]="pageType === importType.graduateList"
                    />
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.firstNameTh }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td class="table__detail">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input
                      pInputText
                      type="text"
                      [(ngModel)]="product.lastNameTh"
                      required
                      [disabled]="pageType === importType.graduateList"
                    />
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.lastNameTh }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td class="table__detail">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <mat-select
                      [disabled]="pageType === importType.graduateList"
                      [ngClass]="
                        pageType === importType.graduateList
                          ? 'disable__prefix'
                          : ''
                      "
                    >
                      <mat-option
                        *ngFor="let EngPrefix of EngPrefixes"
                        [value]="EngPrefix.value"
                      >
                        {{ EngPrefix.label }}
                      </mat-option>
                    </mat-select>
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.titleEn }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td class="table__detail">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input
                      pInputText
                      type="text"
                      [(ngModel)]="product.firstNameEn"
                      required
                      [disabled]="pageType === importType.graduateList"
                    />
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.firstNameEn }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td class="table__detail">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input
                      pInputText
                      type="text"
                      [(ngModel)]="product.lastNameEn"
                      required
                      [disabled]="pageType === importType.graduateList"
                    />
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.lastNameEn }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td class="table__detail">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input
                      class="date__input"
                      pInputText
                      type="text"
                      [(ngModel)]="product.phone"
                      required
                      [disabled]="pageType === importType.graduateList"
                    />
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.phone }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td class="table__detail">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input
                      class="date__input"
                      pInputText
                      type="date"
                      [(ngModel)]="product.birthDate"
                      required
                      [disabled]="pageType === importType.graduateList"
                    />
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ product.birthDate }}
                  </ng-template>
                </p-cellEditor>
              </td>

              <td class="table__detail">
                <div [pRowToggler]="product" class="table__expand">
                  รายละเอียดที่อยู่
                </div>
              </td>

              <td style="text-align: center" class="btn__container">
                <button
                  *ngIf="!editing"
                  type="button"
                  pInitEditableRow
                  (click)="onRowEditInit(product)"
                  class="btn btn-warning btn-edit"
                >
                  แก้ไข
                </button>
                <button
                  *ngIf="editing"
                  type="button"
                  pCancelEditableRow
                  (click)="onRowEditCancel(product, ri)"
                  class="btn btn-outline-primary btn-edit"
                >
                  ยกเลิก
                </button>
                <button
                  *ngIf="editing"
                  type="button"
                  pSaveEditableRow
                  (click)="onRowEditSave(product)"
                  class="btn btn-primary btn-edit"
                >
                  บันทึก
                </button>
              </td>
            </tr>
          </ng-template>

          <ng-template pTemplate="rowexpansion" let-product>
            <tr>
              <td [attr.colspan]="pageType === importType.studentList ? 5 : 5">
                <ksp-form-address
                  >ที่อยู่ตามทะเบียนบ้าน (นักศึกษาชาวไทย) หรือที่พักประจำ
                  (นักศึกษาชาวต่างชาติ)</ksp-form-address
                >
              </td>
            </tr>
          </ng-template>
        </p-table>

        <div class="detail__footer" *ngIf="pageType === importType.studentList">
          <button type="button" class="btn btn-add">
            <img src="/assets/images/img-uni/add-icon.svg" />
            เพิ่มรายชื่อ
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="sticky-bottom border">
  <ksp-bottom-nav
    [isLastPage]="true"
    [isFirstPage]="true"
    [showCenterButtons]="true"
    [showSaveButton]="true"
    [showTempSaveButton]="true"
    (saveClicked)="save()"
    (cancelClicked)="cancel()"
  ></ksp-bottom-nav>
</div>
