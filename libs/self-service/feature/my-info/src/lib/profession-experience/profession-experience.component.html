<ksp-top-nav [isSelfService]="true">
  <span header>ข้อมูลของฉัน</span>
  <span subHeader>ข้อมูลประสบการณ์วิชาชีพ</span>
</ksp-top-nav>

<div class="main__container px-4 py-2 full-height">
  <div class="box-header">ข้อมูลประสบการณ์วิชาชีพ</div>
  <div class="detail__container p-3">
    <form [formGroup]="form">
      <div class="border rounded p-3 mb-3">
        <div class="d-flex justify-content-between">
          <div class="fs-5">สถานศึกษาฝึกประสบการณ์วิชาชีพ</div>
          <div class="text-primary fs-5" role="button">
            <ksp-add-row-button
              [ngClass]="mode === 'view' ? 'text-secondary' : 'text-primary'"
              (addRowClick)="addFormArray(0)"
              [disabled]="mode === 'view'"
            >
              เพิ่ม
            </ksp-add-row-button>
          </div>
        </div>

        <ng-container formArrayName="licenseInfo1">
          <ng-container
            *ngFor="let DegreeForm of licenseInfo1.controls; let i = index"
          >
            <ng-container [formGroupName]="i">
              <hr />
              <div class="d-flex justify-content-end" *ngIf="mode === 'edit'">
                <i
                  class="bi bi-x-circle-fill text-danger"
                  role="button"
                  (click)="deleteFormArray(licenseInfo1, i)"
                ></i>
              </div>

              <self-service-form-user-training-workplace
                [mode]="mode"
                [trainingTimes]="i + 1"
                formControlName="licenseForm"
              ></self-service-form-user-training-workplace> </ng-container></ng-container
        ></ng-container>
      </div>

      <div class="border rounded p-3 mb-3">
        <div class="d-flex justify-content-between">
          <div class="fs-5">สถานศึกษาที่ปฎิบัติการสอน</div>

          <div class="text-primary fs-5" role="button">
            <ksp-add-row-button
              [ngClass]="mode === 'view' ? 'text-secondary' : 'text-primary'"
              (addRowClick)="addFormArray(1)"
              [disabled]="mode === 'view'"
            >
              เพิ่ม
            </ksp-add-row-button>
          </div>
        </div>

        <ng-container formArrayName="licenseInfo2">
          <ng-container
            *ngFor="let DegreeForm of licenseInfo2.controls; let i = index"
          >
            <ng-container [formGroupName]="i">
              <hr />
              <div class="d-flex justify-content-end" *ngIf="mode === 'edit'">
                <i
                  class="bi bi-x-circle-fill text-danger"
                  role="button"
                  (click)="deleteFormArray(licenseInfo2, i)"
                ></i>
              </div>
              <self-service-form-user-workplace
                [mode]="mode"
                formControlName="licenseForm"
                [provinces]="provinces1$ | async"
                [amphurs]="amphurs1$ | async"
                [tumbols]="tumbols1$ | async"
                [bureaus]="bureau$ | async"
                (provinceChanged)="provinceChanged(1, $event)"
                (amphurChanged)="amphurChanged(1, $event)"
              ></self-service-form-user-workplace> </ng-container></ng-container
        ></ng-container>
      </div>

      <div class="border rounded p-3 mb-3">
        <div class="d-flex justify-content-between">
          <div class="fs-5">ใบอนุญาตประกอบวิชาชีพครูจากต่างประเทศ</div>

          <div class="text-primary fs-5" role="button">
            <ksp-add-row-button
              [ngClass]="mode === 'view' ? 'text-secondary' : 'text-primary'"
              (addRowClick)="addFormArray(2)"
              [disabled]="mode === 'view'"
            >
              เพิ่ม
            </ksp-add-row-button>
          </div>
        </div>

        <ng-container formArrayName="licenseInfo3">
          <ng-container
            *ngFor="let DegreeForm of licenseInfo3.controls; let i = index"
          >
            <ng-container [formGroupName]="i">
              <hr />
              <div class="d-flex justify-content-end" *ngIf="mode === 'edit'">
                <i
                  class="bi bi-x-circle-fill text-danger"
                  role="button"
                  (click)="deleteFormArray(licenseInfo3, i)"
                ></i>
              </div>
              <ksp-experience-form
                [mode]="mode"
                [countries]="countries$ | async"
                [licenses]="licenses$ | async"
                formControlName="licenseForm"
              ></ksp-experience-form> </ng-container></ng-container
        ></ng-container>
      </div>
      <div class="mt-3">
        <ksp-form-attachment
          [groups]="info"
          [title]="'กรุณาแนบหลักฐานประกอบวุฒิทางการศึกษา'"
        ></ksp-form-attachment>
      </div>
    </form>
  </div>
  <div class="d-flex justify-content-center my-3">
    <button class="btn btn-secondary me-2">ล้างข้อมูล</button>
    <button
      class="btn"
      (click)="onSave()"
      [ngClass]="mode === 'edit' ? 'btn-success' : 'btn-primary'"
    >
      {{ label }}
    </button>
  </div>
</div>
