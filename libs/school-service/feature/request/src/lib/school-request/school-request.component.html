<ksp-top-nav
  ><span header>ยื่นใบคำขอ</span
  ><span subHeader
    >ขอหนังสืออนุญาตประกอบวิชาชีพ โดยไม่มีใบอนุญาตประกอบวิชาชีพ ({{
      requestLabel
    }})</span
  ></ksp-top-nav
>

<div class="bg-secondary bg-opacity-10 px-4 py-2 full-width-2">
  <div class="box-header">
    รายละเอียดใบคำขอหนังสืออนุญาตประกอบวิชาชีพ โดยไม่มีใบอนุญาตประกอบวิชาชีพ ({{
      requestLabel
    }})
  </div>
  <div [formGroup]="form" class="bg-white py-3 px-4">
    <div>
      <ksp-request-header-info
        [requestDate]="requestDate"
        [requestNumber]="requestNo"
      ></ksp-request-header-info>
      <hr />

      <div class="bg-light px-3 py-2 default-width">
        <div class="box-header text-primary" *ngIf="!requestId">
          ค้นหารายการ
        </div>

        <!-- *ngIf="!requestId || requestSubType !== 5" -->
        <div class="row mb-2" *ngIf="!requestId && requestSubType !== 5">
          <div class="col-5">
            <label class="form-label">หมายเลขบัตรประชาชน</label>
            <input
              class="form-control"
              type="text"
              placeholder="หมายเลขบัตรประชาชนจำนวน 13 หลัก"
              #idcard
            />
          </div>
          <div class="col-1 mt-4">
            <button
              type="button"
              class="btn btn-primary w-100"
              (click)="searchStaffFromIdCard(idcard.value)"
            >
              ค้นหา
            </button>
          </div>
        </div>

        <ksp-form-user-info
          [isDarkMode]="false"
          [prefixList]="prefixList$ | async"
          [nationList]="nationList$ | async"
          [countryList]="countries$ | async"
          [visaClassList]="visaClassList | async"
          [visaTypeList]="visaTypeList | async"
          [displayMode]="[userInfoFormType]"
          formControlName="userInfo"
        ></ksp-form-user-info>
      </div>
    </div>

    <!-- (selectedIndexChange)="onTabIndexChanged($event)" -->
    <div class="full-width pb-2">
      <mat-tab-group class="tab-group mt-3" selectedIndex="0">
        <mat-tab label="ที่อยู่" class="tab-content">
          <ksp-form-address
            [provinces]="provinces$ | async"
            [amphurs]="amphurs1$ | async"
            [tumbols]="tumbols1$ | async"
            (provinceChanged)="provinceChanged(1, $event)"
            (amphurChanged)="amphurChanged(1, $event)"
            formControlName="addr1"
            >ที่อยู่ทะเบียนบ้าน</ksp-form-address
          ><br />
          <ksp-form-address
            [provinces]="provinces$ | async"
            [amphurs]="amphurs2$ | async"
            [tumbols]="tumbols2$ | async"
            (provinceChanged)="provinceChanged(2, $event)"
            (amphurChanged)="amphurChanged(2, $event)"
            formControlName="addr2"
            >ที่อยู่ที่ติดต่อได้สะดวก
            <div class="d-flex align-items-center">
              <input
                (change)="useSameAddress($event)"
                type="checkbox"
                class="me-2"
              />
              <label class="form-label">ที่อยู่ตามทะเบียนบ้าน</label>
            </div>
          </ksp-form-address>

          <div class="text-danger">
            *กรุณากรอกข้อมูลให้ถูกต้องเพื่อประโยชน์ของตัวท่านเอง
            โปรดตรวจสอบอีกครั้งก่อนทำการบันทึกข้อมูลลงในระบบ
          </div>
        </mat-tab>

        <mat-tab label="{{ schoolAddressLabel }}">
          <ng-template matTabContent>
            <ksp-form-school-address
              formControlName="schoolAddr"
            ></ksp-form-school-address>
          </ng-template>
        </mat-tab>

        <mat-tab label="ข้อมูลทางการศึกษา">
          <ng-container *ngIf="requestSubType === 1">
            <ksp-form-education-info
              [showCheckbox]="false"
              formControlName="edu1"
              [showGradeInput]="true"
              [showSelectDegree]="true"
              [showPropertyInput]="false"
              [showSelectDegree]="false"
              [countries]="countries$ | async"
            >
              <div class="box-header">วุฒิการศึกษาปริญญาตรี</div>
            </ksp-form-education-info>
            <br />

            <ksp-form-education-info
              [showCheckbox]="false"
              [showSelectDegree]="false"
              formControlName="edu2"
              [showGradeInput]="false"
              [showPropertyInput]="true"
              [countries]="countries$ | async"
              [option]="true"
            >
              <div class="box-header">
                วุฒิการศึกษาปริญญาโท
              </div> </ksp-form-education-info
            ><br
          /></ng-container>

          <ng-container *ngIf="requestSubType === 2">
            <div class="d-flex align-items-center">
              <input type="checkbox" class="me-2" [formControl]="option1" />
              <label class="fs-5">วุฒิการศึกษาปริญญาตรี</label>
            </div>
            <ng-container *ngIf="Option1$ | async">
              <ksp-form-education-info
                [showCheckbox]="false"
                [showSelectDegree]="false"
                formControlName="edu2"
                [showGradeInput]="true"
                [showPropertyInput]="false"
                [countries]="countries$ | async"
                [option]="true"
              >
              </ksp-form-education-info></ng-container
          ></ng-container>

          <ng-container *ngIf="requestSubType === 5">
            <div class="d-flex align-items-center">
              <input type="checkbox" class="me-2" [formControl]="option1" />
              <label class="fs-5">วุฒิการศึกษาปริญญาตรี</label>
            </div>
            <ng-container *ngIf="Option1$ | async">
              <ksp-form-education-info
                [showCheckbox]="false"
                [showSelectDegree]="false"
                formControlName="edu2"
                [showGradeInput]="false"
                [showPropertyInput]="false"
                [countries]="countries$ | async"
                [option]="true"
                [userEducationType]="userInfoFormType"
              >
              </ksp-form-education-info></ng-container
          ></ng-container>

          <ng-container *ngIf="requestSubType === 2 || requestSubType === 5">
            <div class="d-flex align-items-center mt-3">
              <input type="checkbox" class="me-2" [formControl]="option2" />
              <label class="fs-5">วุฒิประกาศนียบัตรระดับบัณฑิตศึกษา</label>
            </div>
            <ng-container *ngIf="Option2$ | async">
              <ksp-form-education-info
                [showCheckbox]="false"
                [showSelectDegree]="false"
                formControlName="edu2"
                [showGradeInput]="false"
                [showPropertyInput]="false"
                [countries]="countries$ | async"
                [option]="true"
              >
              </ksp-form-education-info></ng-container
          ></ng-container>

          <ng-container *ngIf="requestSubType === 2 || requestSubType === 5">
            <div class="d-flex align-items-center mt-3">
              <input type="checkbox" class="me-2" [formControl]="option3" />
              <label class="fs-5">วุฒิปริญญาโท</label>
            </div>
            <ng-container *ngIf="Option3$ | async">
              <ksp-form-education-info
                [showCheckbox]="false"
                [showSelectDegree]="false"
                formControlName="edu2"
                [showGradeInput]="false"
                [showPropertyInput]="false"
                [countries]="countries$ | async"
                [option]="true"
                [userEducationType]="userInfoFormType"
              >
              </ksp-form-education-info></ng-container
          ></ng-container>

          <ng-container *ngIf="requestSubType === 2 || requestSubType === 5">
            <div class="d-flex align-items-center mt-3">
              <input type="checkbox" class="me-2" [formControl]="option4" />
              <label class="fs-5">วุฒิปริญญาเอก</label>
            </div>
            <ng-container *ngIf="Option4$ | async">
              <ksp-form-education-info
                [showCheckbox]="false"
                [showSelectDegree]="false"
                formControlName="edu2"
                [showGradeInput]="false"
                [showPropertyInput]="false"
                [countries]="countries$ | async"
                [option]="true"
                [userEducationType]="userInfoFormType"
              >
              </ksp-form-education-info></ng-container
          ></ng-container>

          <ng-container *ngIf="requestSubType === 2 || requestSubType === 5">
            <div class="d-flex align-items-center mt-3">
              <input type="checkbox" class="me-2" [formControl]="option5" />
              <label class="fs-5">วุฒิการศึกษาอื่นๆ</label>
            </div>
            <ng-container *ngIf="Option5$ | async">
              <ksp-form-education-info
                [showCheckbox]="false"
                [showSelectDegree]="false"
                formControlName="edu2"
                [showGradeInput]="false"
                [showPropertyInput]="false"
                [countries]="countries$ | async"
                [option]="true"
                [userEducationType]="userInfoFormType"
              >
              </ksp-form-education-info> </ng-container
          ></ng-container>

          <ng-container *ngIf="requestSubType === 2">
            <div class="d-flex align-items-center mt-3">
              <input type="checkbox" class="me-2" [formControl]="option6" />
              <label class="fs-5"
                >คุณสมบัติอื่นที่สอดคล้องหรือเป็นประโยชน์ต่อการจัดการเรียนการสอนในกลุ่มสาระหรือรายวิชาที่สอน
                (พิจารณาเป็นรายกรณี)</label
              >
            </div>
            <ng-container *ngIf="Option6$ | async">
              <div class="row">
                <div class="col">
                  <textarea
                    class="form-control"
                    rows="3"
                    placeholder="โปรดระบุ"
                  ></textarea>
                </div></div></ng-container
            ><br
          /></ng-container>

          <ng-container *ngIf="requestSubType === 5">
            <div class="d-flex align-items-center mt-3">
              <input type="checkbox" class="me-2" [formControl]="option6" />
              <label class="fs-5">ใบอนุญาตประกอบวิชาชีพครูจากต่างประเทศ </label>
            </div>
            <ng-container *ngIf="Option6$ | async">
              <ksp-form-education-info-manager></ksp-form-education-info-manager></ng-container
            ><br
          /></ng-container>

          <ksp-form-attachment
            [pageType]="pageType.educationTab"
            [uniqueTimestamp]="uniqueTimestamp"
            [groups]="eduFiles"
          ></ksp-form-attachment>
        </mat-tab>

        <mat-tab label="ข้อมูลการสอนและการจ้าง">
          <ng-container *ngIf="requestSubType === 1 || requestSubType === 5">
            <ksp-form-teaching-info
              formControlName="teachinginfo"
            ></ksp-form-teaching-info
            ><br />
          </ng-container>

          <ng-container *ngIf="requestSubType === 2">
            <ksp-form-teaching-info-manager></ksp-form-teaching-info-manager
            ><br
          /></ng-container>

          <ksp-form-hiring-info
            [displayMode]="'request'"
            formControlName="hiringinfo"
            [staffTypes]="staffTypes$ | async"
            [positionTypes]="positionTypes$ | async"
            [academicStandingList]="academicTypes$ | async"
          ></ksp-form-hiring-info>
          <br />
          <ksp-form-temp-license-number></ksp-form-temp-license-number>
          <br />
          <ksp-form-attachment
            [uniqueTimestamp]="uniqueTimestamp"
            [pageType]="pageType.teachingTab"
            [groups]="teachingFiles"
          ></ksp-form-attachment>
        </mat-tab>

        <mat-tab label="ข้อมูลชี้แจงเหตุผล">
          <ng-container *ngIf="requestSubType === 1 || requestSubType === 5">
            <ksp-form-reason-info
              [requestType]="1"
              formControlName="reasoninfo"
            ></ksp-form-reason-info
          ></ng-container>
          <ng-container *ngIf="requestSubType === 2">
            <ksp-form-reason-info
              [requestType]="2"
              formControlName="reasoninfo"
            ></ksp-form-reason-info
          ></ng-container>
          <br />
          <ksp-form-attachment
            [uniqueTimestamp]="uniqueTimestamp"
            [pageType]="pageType.reasonTab"
            [groups]="reasonFiles"
          ></ksp-form-attachment>
        </mat-tab>

        <mat-tab label="เอกสารหลักฐานประกอบ">
          <ksp-form-attachment
            [uniqueTimestamp]="uniqueTimestamp"
            [pageType]="pageType.fileAttachTab"
            [groups]="attachFiles"
          ></ksp-form-attachment>
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>
</div>

<div class="sticky-bottom border px-2">
  <ksp-bottom-nav
    (prevClicked)="backToListPage()"
    (cancelClicked)="cancel()"
    (tempSaveClicked)="tempBtnClick()"
    (saveClicked)="permanentBtnClick()"
    [colorMode]="'green'"
    [isLastPage]="true"
    [showCenterButtons]="true"
    [cancelButtonLabel]="'ยกเลิกใบคำขอ'"
    [showCancelButton]="requestId > 0"
    [showTempSaveButton]="true"
    [disableTempSaveButton]="disableTempSave"
    [showSaveButton]="true"
    [saveButtonLabel]="'บันทึกและยื่น'"
    [disableSaveButton]="disableSave"
    [disableCancelButton]="disableCancel"
  ></ksp-bottom-nav>
</div>
