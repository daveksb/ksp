<ksp-top-nav
  ><span header>ยื่นใบคำขอ</span
  ><span subHeader
    >ขอใบอนุญาตให้ประกอบวิชาชีพ โดยไม่มีใบอนุญาตประกอบวิชาชีพ
    {{ requestTypeLabel }}</span
  ></ksp-top-nav
>

<div class="bg-secondary bg-opacity-10 px-4 py-2 full-width-2">
  <div class="box-header">
    รายละเอียดใบคำขอหนังสืออนุญาตประกอบวิชาชีพ โดยไม่มีใบอนุญาตประกอบวิชาชีพ
    {{ requestTypeLabel }}
  </div>
  <div [formGroup]="form" class="bg-white py-3 px-4">
    <div>
      <ksp-request-header-info
        [requestDate]="'10 ตุลาคม 2565'"
        [requestNumber]="'112234467876545'"
      ></ksp-request-header-info>
      <hr />

      <div class="bg-light px-3 py-2 default-width">
        <div class="box-header text-primary">ค้นหารายการ</div>

        <div class="row mb-3">
          <div class="col-5">
            <label class="form-label">หมายเลขบัตรประชาชน</label>
            <input
              class="form-control form-search"
              type="text"
              placeholder="หมายเลขบัตรประชาชนจำนวน 13 หลัก"
              #idcard
            />
          </div>
          <div class="col-3 mt-4">
            <button
              type="button"
              class="btn btn-secondary"
              (click)="searchStaff(idcard.value)"
            >
              ค้นหา
            </button>
          </div>
        </div>
        <ksp-form-user-info
          [isDarkMode]="false"
          [prefixList]="prefixList$ | async"
          formControlName="userInfo"
        ></ksp-form-user-info>
      </div>
    </div>

    <div class="full-width pb-2">
      <mat-tab-group
        (selectedIndexChange)="onTabIndexChanged($event)"
        class="tab-group mt-3"
        selectedIndex="1"
      >
        <mat-tab label="ที่อยู่" class="tab-content">
          <ksp-form-address
            [provinces]="provinces$ | async"
            [amphurs]="amphurs1$ | async"
            [tumbols]="tumbols1$ | async"
            formControlName="addr1"
            >ที่อยู่ทะเบียนบ้าน</ksp-form-address
          ><br />
          <ksp-form-address
            [provinces]="provinces$ | async"
            [amphurs]="amphurs2$ | async"
            [tumbols]="tumbols2$ | async"
            formControlName="addr2"
            >ที่อยู่ที่ติดต่อได้สะดวก
            <div class="d-flex align-items-center">
              <input
                (change)="useSameAddress($event)"
                type="checkbox"
                class="me-2"
              />
              <label class="form-label">ที่อยู่ตามทะเบียนบ้าน</label>
            </div>
          </ksp-form-address>

          <div class="text-danger">
            *กรุณากรอกข้อมูลให้ถูกต้องเพื่อประโยชน์ของตัวท่านเอง
            โปรดตรวจสอบอีกครั้งก่อนทำการบันทึกข้อมูลลงในระบบ
          </div>
        </mat-tab>

        <mat-tab label="{{ schoolAddressLabel }}">
          <ng-template matTabContent>
            <ksp-form-school-address
              formControlName="schoolAddr"
            ></ksp-form-school-address>
          </ng-template>
        </mat-tab>

        <mat-tab label="ข้อมูลทางการศึกษา">
          <ksp-form-education-info
            formControlName="edu1"
            [showGradeInput]="true"
            >วุฒิการศึกษาปริญญาตรี</ksp-form-education-info
          ><br />
          <ksp-form-education-info
            formControlName="edu2"
            [showGradeInput]="false"
            [showPropertyInput]="true"
            >วุฒิการศึกษาปริญญาโท
          </ksp-form-education-info>

          <br />
          <ksp-form-attachment [groups]="educationInfo"></ksp-form-attachment>
        </mat-tab>

        <mat-tab label="ข้อมูลการสอนและการจ้าง">
          <ksp-form-teaching-info
            formControlName="teachingInfo"
          ></ksp-form-teaching-info>
          <ksp-form-hiring-info
            [positionTypes]="positionTypes$ | async"
            formControlName="hiringInfo"
          ></ksp-form-hiring-info>

          <!--           <div class="bg-light px-3 py-3">
            <div class="box-header">การขอหนังสืออนุญาตชั่วคราว</div>

            <div class="row">
              <div class="col mb-3">
                <label class="form-label">ขออนุญาตฉบับที่</label>
                <input
                  class="form-control"
                  type="text"
                  formControlName="contractNumber"
                />
              </div>
            </div>

            <table class="table w-25">
              <thead>
                <tr>
                  <th scope="col">ลำดับ</th>
                  <th scope="col">วันที่ยื่นคำขอ</th>
                  <th scope="col">วันหมดอายุ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">1</th>
                  <td>10 พ.ค.2564</td>
                  <td>1 พ.ค.2564</td>
                </tr>
              </tbody>
            </table>
          </div> -->

          <ksp-form-attachment [groups]="teachingInfo"></ksp-form-attachment>
        </mat-tab>

        <mat-tab label="ข้อมูลชี้แจงเหตุผล">
          <ksp-form-reason-info></ksp-form-reason-info>
          <br />
          <ksp-form-attachment [groups]="reasonInfo"></ksp-form-attachment>
        </mat-tab>

        <mat-tab label="เอกสารหลักฐานประกอบ">
          <ksp-form-attachment [groups]="evidenceFiles"></ksp-form-attachment>
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>
</div>

<div class="sticky-bottom border">
  <ksp-bottom-nav
    (saveClicked)="addTempLicense()"
    (cancelClicked)="backToListPage()"
    (tempSaveClicked)="backToListPage()"
    [isFirstPage]="true"
    [colorMode]="'green'"
    [isLastPage]="true"
    [showCenterButtons]="true"
    [showCancelButton]="true"
    [showTempSaveButton]="true"
    [disableTempSaveButton]="!form.valid"
    [showSaveButton]="true"
    [saveButtonLabel]="'ส่งใบคำขอ'"
  ></ksp-bottom-nav>
  <!-- [showSaveButton]="selectedTabIndex === 5"
  -->
</div>
